(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{318:function(e,t,r){},476:function(e,t){},494:function(e,t,r){e.exports=r(962)},649:function(e,t){},651:function(e,t){},683:function(e,t){},684:function(e,t){},868:function(e,t,r){var a={"./geojson.json":455,"./table-schema.json":869,"./topojson.json":456};function n(e){var t=c(e);return r(t)}function c(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=c,e.exports=n,n.id=868},953:function(e,t){},954:function(e,t){},958:function(e,t){},959:function(e,t){},962:function(e,t,r){"use strict";r.r(t);var a=r(4),n=r.n(a),c=r(117),o=r.n(c),i=r(230),s=r(118),u=r(479),l=r(480),d=function(e){if(!e)return{};switch((e.views||[]).length){case 1:return e.views[0];case 2:return e.views[1];default:return function(e){try{return{resources:[{schema:e.resources[0].schema}]}}catch(t){return{}}}(e)}},p=function(e){return JSON.parse(JSON.stringify(e))},f=Object(s.combineReducers)({dataViewBuilder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case"DATA_VIEW_BUILDER_ACTION":default:return e}},filterUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case"FILTER_UI_ACTION":default:return e}},sharedState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATA_VIEW_BUILDER_ACTION":var r=p(e.datapackage);return 1===r.views.length&&r.views.unshift(t.payload),r.views.length>1&&(r.views[0]=t.payload),Object.assign(p(e),{datapackage:r});case"FILTER_UI_ACTION":var a=p(e.datapackage);return a.resources[0]=t.payload,Object.assign(p(e),{datapackage:a});case"FETCH_DATA_BEGIN":return Object.assign({},e,{loading:!0});case"FETCH_DATA_SUCCESS":return Object.assign({},e,{loading:!1,error:!1,datapackage:t.payload.datapackage});case"FETCH_DATA_FAILURE":return Object.assign({},e,{loading:!1,error:!0,errorBody:t.payload});default:return e}}}),v={dataViewBuilder:{},filterUI:{},sharedState:{loading:!1,datapackage:{},loadedData:{}}};r(318);var b=r(29),h=r(481),w=r(485),g=r.n(w),m=r(486),O=r.n(m),y=function(e){var t=e.datapackage.views;return n.a.createElement(g.a,{loaded:!e.loading},n.a.createElement("div",null,t.map(function(e){return n.a.createElement(O.a,{key:Math.random(),datapackage:{views:[e]}})})))},k=r(491),j=r(59),E=r.n(j),x=r(148),A=r(314),D=r(492),S=r(411);function _(e){try{return JSON.parse(e)}catch(t){return e}}function I(e){return e.views.map(function(t){return A.compileView(t,e)})}var N=function(){var e=Object(x.a)(E.a.mark(function e(t){var r,a,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_(t),a=["csv","tsv","dsv","xls","xlsx"],e.prev=2,e.next=5,D.Dataset.load(r);case 5:return n=e.sent,e.next=8,Promise.all(n.resources.map(function(){var e=Object(x.a)(E.a.mark(function e(t){var r,n,c,o,i,s;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("FileInline"!==t.displayName){e.next=4;break}return e.abrupt("return");case 4:if(!t.descriptor.path||!t.descriptor.path.includes("datastore_search")){e.next=17;break}return e.next=7,fetch(t.descriptor.path);case 7:if((r=e.sent).ok){e.next=11;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 11:return e.next=13,r.json();case 13:n=e.sent,t.descriptor.data=n.result.records,e.next=60;break;case 17:if("FileRemote"!==t.displayName||!a.includes(t.descriptor.format)){e.next=36;break}return e.prev=18,e.next=21,t.rows({size:100,keyed:!0});case 21:return c=e.sent,e.next=24,S(c);case 24:return(o=e.sent).length>0?t.descriptor.data=o:t.descriptor.unavailable=!0,e.next=28,t.addSchema();case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(18),console.warn(e.t0),t.descriptor.unavailable=!0;case 34:e.next=60;break;case 36:if(!t.descriptor.format.toLowerCase().includes("json")){e.next=55;break}return e.next=39,fetch(t.descriptor.path);case 39:if((i=e.sent).ok){e.next=43;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 43:return e.next=45,i.json();case 45:if(s=e.sent,!["Feature","FeatureCollection","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"].includes(s.type)){e.next=51;break}t.descriptor.data=s,e.next=53;break;case 51:return t.descriptor.unavailable=!0,e.abrupt("return");case 53:e.next=60;break;case 55:if("pdf"!==t.descriptor.format.toLowerCase()){e.next=59;break}return e.abrupt("return");case 59:t.descriptor.unavailable=!0;case 60:case"end":return e.stop()}},e,null,[[18,30]])}));return function(t){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",I(n.descriptor));case 11:return e.prev=11,e.t0=e.catch(2),console.warn("Failed to load a Dataset from provided datapackage id\n"+e.t0),e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[2,11]])}));return function(t){return e.apply(this,arguments)}}();function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(r,!0).forEach(function(t){Object(b.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var C=function(){return{type:"FETCH_DATA_BEGIN"}},B=function(e){return{type:"FETCH_DATA_SUCCESS",payload:P({},e)}};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var U=Object(i.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(r,!0).forEach(function(t){Object(b.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e)},function(e){return{filterUIAction:function(t){return e(function(e){return function(){var t=Object(x.a)(E.a.mark(function t(r,a){var n,c,o;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:"FILTER_UI_ACTION",payload:e}),(n=a().sharedState.datapackage).resources[0].data&&delete n.resources[0].data,r(C()),t.next=6,N(n);case 6:c=t.sent,(o=JSON.parse(JSON.stringify(n))).views=c,r(B({datapackage:o}));case 10:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()}(t))},fetchDataAction:function(t){return e(function(e){return function(){var t=Object(x.a)(E.a.mark(function t(r){var a,n;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r(C()),t.next=3,N(e.datapackage);case 3:a=t.sent,(n=JSON.parse(JSON.stringify(e.datapackage))).views=a,r(B({datapackage:n}));case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(t))},dataViewBuilderAction:function(t){return e(function(e){return function(t){t({type:"DATA_VIEW_BUILDER_ACTION",payload:e})}}(t))}}})(function(e){return Object(a.useEffect)(function(){var t={datapackage:e.sharedState.datapackage};e.fetchDataAction(t)},[]),n.a.createElement("div",{className:"text-center ml-6"},n.a.createElement("header",null,n.a.createElement("div",{className:"container"},n.a.createElement("h1",{className:"text-3xl"},"Data Explorer"))),n.a.createElement("div",{className:"container py-4"},n.a.createElement("div",{className:""},n.a.createElement(h.QueryBuilder,{resource:(t=e.sharedState.datapackage,t?t.resources[0]:{}),filterBuilderAction:e.filterUIAction}))),n.a.createElement("div",{className:"container flex py-6"},n.a.createElement("div",{className:"w-3/4 p-4 mr-4 overflow-x-auto border-r-2"},n.a.createElement(y,e.sharedState)),n.a.createElement("div",{className:"w-1/4 p-4 mr-4"},n.a.createElement(k.ChartBuilder,{view:d(e.sharedState.datapackage),dataViewBuilderAction:e.dataViewBuilderAction}))));var t});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L,J=window.DP_ID;o.a.render(n.a.createElement(i.a,{store:(L={sharedState:{datapackage:J}},Object(s.createStore)(f,Object.assign({},v,L),Object(u.composeWithDevTools)(Object(s.applyMiddleware)(l.a))))},n.a.createElement(U,null)),document.getElementById("data-explorer")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[494,1,2]]]);
//# sourceMappingURL=main.5e1b92fa.chunk.js.map